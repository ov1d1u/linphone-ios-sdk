<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Liblinphone: Chat room and messaging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Liblinphone<span id="projectnumber">&#160;5.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div class="header">
  <div class="headertitle"><div class="title">Chat room and messaging</div></div>
</div><!--header-->
<div class="contents">

<p>This program is a <em>very</em> simple usage example of liblinphone, desmonstrating how to send/receive SIP MESSAGE from a sip uri identity passed from the command line.  
</p>
<p>This program is a <em>very</em> simple usage example of liblinphone, desmonstrating how to send/receive SIP MESSAGE from a sip uri identity passed from the command line. </p>
<p>This program is a <em>very</em> simple usage example of liblinphone, desmonstrating how to send/receive SIP MESSAGE from a sip uri identity passed from the command line.</p>
<p><br  />
Argument must be like sip:<a href="#" onclick="location.href='mai'+'lto:'+'jeh'+'an'+'@si'+'p.'+'lin'+'ph'+'one'+'.o'+'rg'; return false;">jehan<span class="obfuscator">.nosp@m.</span>@sip<span class="obfuscator">.nosp@m.</span>.linp<span class="obfuscator">.nosp@m.</span>hone<span class="obfuscator">.nosp@m.</span>.org</a> . <br  />
 ex chatroom sip:<a href="#" onclick="location.href='mai'+'lto:'+'jeh'+'an'+'@si'+'p.'+'lin'+'ph'+'one'+'.o'+'rg'; return false;">jehan<span class="obfuscator">.nosp@m.</span>@sip<span class="obfuscator">.nosp@m.</span>.linp<span class="obfuscator">.nosp@m.</span>hone<span class="obfuscator">.nosp@m.</span>.org</a> <br  />
 </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Copyright (c) 2010-2022 Belledonne Communications SARL.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of Liblinphone</span></div>
<div class="line"><span class="comment"> * (see https://gitlab.linphone.org/BC/public/liblinphone).</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> * it under the terms of the GNU Affero General Public License as</span></div>
<div class="line"><span class="comment"> * published by the Free Software Foundation, either version 3 of the</span></div>
<div class="line"><span class="comment"> * License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> * GNU Affero General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * You should have received a copy of the GNU Affero General Public License</span></div>
<div class="line"><span class="comment"> * along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;linphone/core.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> bool_t running = TRUE;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> stop(<span class="keywordtype">int</span> signum) {</div>
<div class="line">        running = FALSE;</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> text_received(<a class="code hl_typedef" href="group__initializing.html#gaa5cf635b82dd338e7ee2dd3599d05f0a">LinphoneCore</a> *lc, <a class="code hl_typedef" href="group__chatroom.html#ga37902f3fc715b7f6451c241d0efd0299">LinphoneChatRoom</a> *room, <span class="keyword">const</span> <a class="code hl_typedef" href="group__linphone__address.html#ga805d79aa8486fc79616c979fe9a51021">LinphoneAddress</a> *from, <span class="keyword">const</span> <span class="keywordtype">char</span> *message) {</div>
<div class="line">        printf(<span class="stringliteral">&quot; Message [%s] received from [%s] \n&quot;</span>, message, <a class="code hl_function" href="group__linphone__address.html#ga3701255db47362a8a7d1e86c591f75f8">linphone_address_as_string</a>(from));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__initializing.html#gaa5cf635b82dd338e7ee2dd3599d05f0a">LinphoneCore</a> *lc;</div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">        <a class="code hl_struct" href="struct__LinphoneCoreVTable.html">LinphoneCoreVTable</a> vtable = {0};</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">char</span> *dest_friend = NULL;</div>
<div class="line">        <a class="code hl_typedef" href="group__chatroom.html#ga37902f3fc715b7f6451c241d0efd0299">LinphoneChatRoom</a> *chat_room;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* takes   sip uri  identity from the command line arguments */</span></div>
<div class="line">        <span class="keywordflow">if</span> (argc &gt; 1) {</div>
<div class="line">                dest_friend = argv[1];</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        signal(SIGINT, stop);</div>
<div class="line"><span class="comment">//#define DEBUG_LOGS</span></div>
<div class="line"><span class="preprocessor">#ifdef DEBUG_LOGS</span></div>
<div class="line">        linphone_core_enable_logs(NULL); <span class="comment">/*enable liblinphone logs.*/</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         Fill the LinphoneCoreVTable with application callbacks.</span></div>
<div class="line"><span class="comment">         All are optional. Here we only use the text_received callback</span></div>
<div class="line"><span class="comment">         in order to get notifications about incoming message.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        vtable.<a class="code hl_variable" href="struct__LinphoneCoreVTable.html#a5b101f313df29f3ddedcfdba885b4757">text_received</a> = text_received;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         Instantiate a LinphoneCore object given the LinphoneCoreVTable</span></div>
<div class="line"><span class="comment">        */</span></div>
<div class="line">        lc = <a class="code hl_function" href="group__initializing.html#ga3cb838fd03dc4bacd2aaee45432b1456">linphone_core_new</a>(&amp;vtable, NULL, NULL, NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/*Next step is to create a chat root*/</span></div>
<div class="line">        chat_room = <a class="code hl_function" href="group__chatroom.html#ga1288096dd3a21f6eafd8df5b0cae337d">linphone_core_create_chat_room</a>(lc, dest_friend);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="group__chatroom.html#ga843794112b17bd21fdba786f61d51e09">linphone_chat_room_send_message</a>(chat_room, <span class="stringliteral">&quot;Hello world&quot;</span>); <span class="comment">/*sending message*/</span></div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="group__chatroom.html#ga5446c8b81abae93090e855990585df9d">linphone_chat_room_unref</a>(chat_room);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* main loop for receiving incoming messages and doing background linphone core work: */</span></div>
<div class="line">        <span class="keywordflow">while</span> (running) {</div>
<div class="line">                <a class="code hl_function" href="group__initializing.html#ga37291e322c791983d332f9f561211405">linphone_core_iterate</a>(lc);</div>
<div class="line">                ms_usleep(50000);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Shutting down...\n&quot;</span>);</div>
<div class="line">        <a class="code hl_function" href="group__initializing.html#gad942d8625e906eb19190ca8cde44aa69">linphone_core_destroy</a>(lc);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Exited\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__chatroom_html_ga1288096dd3a21f6eafd8df5b0cae337d"><div class="ttname"><a href="group__chatroom.html#ga1288096dd3a21f6eafd8df5b0cae337d">linphone_core_create_chat_room</a></div><div class="ttdeci">MS2_DEPRECATED LinphoneChatRoom * linphone_core_create_chat_room(LinphoneCore *core, const LinphoneChatRoomParams *params, const LinphoneAddress *localAddr, const char *subject, const bctbx_list_t *participants)</div><div class="ttdoc">Create a chat room.</div></div>
<div class="ttc" id="agroup__chatroom_html_ga37902f3fc715b7f6451c241d0efd0299"><div class="ttname"><a href="group__chatroom.html#ga37902f3fc715b7f6451c241d0efd0299">LinphoneChatRoom</a></div><div class="ttdeci">struct _LinphoneChatRoom LinphoneChatRoom</div><div class="ttdoc">A chat room is the place where LinphoneChatMessage are exchanged.</div><div class="ttdef"><b>Definition</b> c-types.h:460</div></div>
<div class="ttc" id="agroup__chatroom_html_ga5446c8b81abae93090e855990585df9d"><div class="ttname"><a href="group__chatroom.html#ga5446c8b81abae93090e855990585df9d">linphone_chat_room_unref</a></div><div class="ttdeci">void linphone_chat_room_unref(LinphoneChatRoom *chat_room)</div><div class="ttdoc">Release reference to the chat room.</div></div>
<div class="ttc" id="agroup__chatroom_html_ga843794112b17bd21fdba786f61d51e09"><div class="ttname"><a href="group__chatroom.html#ga843794112b17bd21fdba786f61d51e09">linphone_chat_room_send_message</a></div><div class="ttdeci">MS2_DEPRECATED void linphone_chat_room_send_message(LinphoneChatRoom *chat_room, const char *message)</div><div class="ttdoc">Send a message to peer member of this chat room.</div></div>
<div class="ttc" id="agroup__initializing_html_ga37291e322c791983d332f9f561211405"><div class="ttname"><a href="group__initializing.html#ga37291e322c791983d332f9f561211405">linphone_core_iterate</a></div><div class="ttdeci">void linphone_core_iterate(LinphoneCore *core)</div><div class="ttdoc">Main loop function.</div></div>
<div class="ttc" id="agroup__initializing_html_ga3cb838fd03dc4bacd2aaee45432b1456"><div class="ttname"><a href="group__initializing.html#ga3cb838fd03dc4bacd2aaee45432b1456">linphone_core_new</a></div><div class="ttdeci">MS2_DEPRECATED LinphoneCore * linphone_core_new(const LinphoneCoreVTable *vtable, const char *config_path, const char *factory_config_path, void *userdata)</div><div class="ttdoc">Instanciates a LinphoneCore object.</div></div>
<div class="ttc" id="agroup__initializing_html_gaa5cf635b82dd338e7ee2dd3599d05f0a"><div class="ttname"><a href="group__initializing.html#gaa5cf635b82dd338e7ee2dd3599d05f0a">LinphoneCore</a></div><div class="ttdeci">struct _LinphoneCore LinphoneCore</div><div class="ttdoc">Main object to instanciate and on which to keep a reference.</div><div class="ttdef"><b>Definition</b> types.h:493</div></div>
<div class="ttc" id="agroup__initializing_html_gad942d8625e906eb19190ca8cde44aa69"><div class="ttname"><a href="group__initializing.html#gad942d8625e906eb19190ca8cde44aa69">linphone_core_destroy</a></div><div class="ttdeci">MS2_DEPRECATED void linphone_core_destroy(LinphoneCore *core)</div><div class="ttdoc">Destroys a LinphoneCore.</div></div>
<div class="ttc" id="agroup__linphone__address_html_ga3701255db47362a8a7d1e86c591f75f8"><div class="ttname"><a href="group__linphone__address.html#ga3701255db47362a8a7d1e86c591f75f8">linphone_address_as_string</a></div><div class="ttdeci">char * linphone_address_as_string(const LinphoneAddress *address)</div><div class="ttdoc">Returns the address as a string.</div></div>
<div class="ttc" id="agroup__linphone__address_html_ga805d79aa8486fc79616c979fe9a51021"><div class="ttname"><a href="group__linphone__address.html#ga805d79aa8486fc79616c979fe9a51021">LinphoneAddress</a></div><div class="ttdeci">struct _LinphoneAddress LinphoneAddress</div><div class="ttdoc">Object that represents a parsed SIP address.</div><div class="ttdef"><b>Definition</b> c-types.h:155</div></div>
<div class="ttc" id="astruct__LinphoneCoreVTable_html"><div class="ttname"><a href="struct__LinphoneCoreVTable.html">_LinphoneCoreVTable</a></div><div class="ttdoc">This structure holds all callbacks that the application should implement.</div><div class="ttdef"><b>Definition</b> core.h:210</div></div>
<div class="ttc" id="astruct__LinphoneCoreVTable_html_a5b101f313df29f3ddedcfdba885b4757"><div class="ttname"><a href="struct__LinphoneCoreVTable.html#a5b101f313df29f3ddedcfdba885b4757">_LinphoneCoreVTable::text_received</a></div><div class="ttdeci">MS2_DEPRECATED LinphoneCoreTextMessageReceivedCb text_received</div><div class="ttdoc">Notifies configuring status changes.</div><div class="ttdef"><b>Definition</b> core.h:259</div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
